# 集合的分布式随机分配以及验证

## 问题描述：
有一个参与方都统一认可的公开集合S，这里没有中心化的服务，需要让参与方从集合S中选择元素，有几个要求：
1. 在它选择元素之前它不能知道它将要选择的元素的真实值，当然其他参与者也无法知道。
2. 在它的选择被所有参与者确认且不可篡改后，它可以知道它已经选择的元素的真实值，但其他参与者仍然无法知道。
3. 在它公开它所选择的元素的真实值后，参与者可以验证它确实选择了这个元素。
4. 参与者不能篡改数据或者篡改可以被证明且被惩罚。

## 背景：
+ 非对称加密
+ 可交换加密
+ 哈希

## 算法描述：
### 前置：
集合S中元素个数为L。
各个参与方生成自己的可交换加密密钥对集合M，共L个，公私钥都需要保密，各参与方将自己的L个公钥的hash公开。

### 分配：
1. 从第一个参与方开始，将集合S随机乱序得到新集合S'，对每个集合元素S'(i)使用公钥M(i)加密，得到新的结合S。
2. 将S传递给下一个参与者，同样首先将集合S随机乱序得到集合S'，对每个集合元素S'(i)使用公钥M(i)加密，最终得到新的集合S。
3. 重复执行，直到最后一个参与者完成上述过程2。
4. 将最后得到集合S中的元素分配给各个参与者。

### 解释：
各个参与者拿到的是使用可交换加密算法多次签名的加密元素，并不知道其真实值，这时参与者需要将自己的加密元素发给其他参与者进行解释。

1. 参与者A将自己的加密元素发给其他的一个参与者B。
2. 参与者B使用自己的私钥解密元素，并发回给A。
3. 参与者A拿到结果后，将元素发给其他的下一个参与者C。
4. 重复上述过程，直到参与者A发给了其他的所有参与者。
5. 参与者A使用自己的私钥解密元素，得到自己分配到的元素的真实值。

以上过程，参与者A发给其他的所有参与者是没有顺序要求的。最后只有A知道元素的真实值，其他参与者都无法知道元素真实值，虽然他们都参与了解释过程。

### 验证：
在一个参与者公开自己分配到的元素后，同时公布加密该元素的私钥，其他参与者可以通过解密来验证。